with facebook as (
   select t1.ad_date,
   t3.campaign_name,
   t2.adset_name,
   t1.spend,
   t1.impressions,
   t1.reach,
   t1.clicks,
   t1.leads,
   t1.value
   from "public".facebook_ads_basic_daily as t1
   left join facebook_adset as t2
     on t1.adset_id = t2.adset_id
   left join facebook_campaign as t3
   on t1.campaign_id = t3.campaign_id
 ),
google_facebook as (
    select
b.ad_date,
 'Facebook Ads' as media_source,b.campaign_name, b.adset_name,b.spend,b.impressions,b.reach,b.clicks,b.leads,b.value
from  facebook as b
Union all
    Select
ad_date,
'Google Ads' as media_source, campaign_name, adset_name,spend,impressions,reach,clicks,leads,value
   from "public".google_ads_basic_daily
)
select ad_date, media_source, campaign_name, adset_name,

sum (value)::numeric / sum (spend) as romi

from google_facebook
where value > 0 and spend > 0
group by ad_date, media_source, campaign_name, adset_name
Order by romi desc
limit 5
